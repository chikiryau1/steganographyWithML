\chapter*{Vvedenie}Cifrovaya steganografiya - ehto metod skrytiya informacii v cifrovyh kontejnerah, v kachestve kotoryh mogut ispol'zovat'sya lyubye media-fajly. Metod mozhet byt' ispol'zovan dlya vypolneniya takih celej \cite{Gribunin}:\begin{enumerate}\item skrytaya peredachi dannyh;\item vstraivanie cifrovyh vodyanyh znakov (CVZ);\item vstraivanie zagolovkov.\end{enumerate}Steganografiya, v otlichii ot kriptografii, ne shifruet sekretnoe soobshchenie, a skryvaet sam fakt ego peredachi. Takim obrazom vypolnyaetsya cel' skrytoj peredachi dannyh. CVZ mogut primenyat'sya dlya zashchity cifrovyh dannyh ot nezakonnogo kopirovaniya i nesankcionirovannogo ispol'zovaniya, chto pozvolyaet zashchishchat' avtorskie prava i intellektual'nuyu sobstvennost'. Vstraivanie zagolovkov mozhet primenyat'sya, naprimer, dlya podpisi medicinskih snimkov.Samaya shiroko primenyaemaya tekhnika steganografii ehto vstraivanie informacii v izobrazheniya. Glavnaya zadacha algoritmov ispol'zuyushchih ehtu tekhniku, sostoit v tom, chtoby vnesennye izmeneniya ne byli zametny pri vizual'nom kontrole (sravnenii iskhodnogo i stego-izobrazheniya). Obychnye algoritmy steganografii ispol'zuyut tot fakt, chto uroven' tochnosti kodirovaniya izobrazhenij vo mnogih formatah namnogo bol'she, chem tochnost' vospriyatiya zreniya cheloveka. Iz-za ehtogo, takie algoritmy imeyut zhestkie ogranicheniya, svyazannye s razmerom vstraivaemyh dannyh.Algoritmy steganografii, osnovannye na mashinnom obuchenii v nashe vremya ne ochen' rasprostraneny, odnako, modifikacii metodov s pomoshch'yu nejrosetevyh tekhnologij mogut znachitel'no uluchshit' ehffektivnost' ih raboty. Naprimer, obychnyj algoritm LSB \cite{LSB}, zaklyuchayushchijsya v zamene naimen'shih znachashchih bitov v pikselyah izobrazhenij na bity skryvaemogo soobshcheniya, mozhno modificirovat', ispol'zuya nejroset' dlya analiza i ucheta osobennostej izobrazheniya.Cel'yu nastoyashchej diplomnoj raboty yavlyaetsya sravnit' algoritmy steganografii, osnovannye na mashinnom obuchenii.Dlya dostizheniya ukazannoj celi neobhodimo reshit' sleduyushchie zadachi: realizovat' bazovyj algoritm LSB, modificirovat' ego s pomoshch'yu mashinnogo obucheniya, postroit' matematicheskuyu model' dlya ocenki kachestva i ehffektivnosti raboty algoritmov, provesti analiz rezul'tatov ocenok.\chapter{Nabor dannyh} \label{chapt1}V rabote ispol'zuyutsya cifrovye izobrazheniya iz bazy dannyh USC-SIPI \cite{USC}, kotoraya sushchestvuet dlya issledovanij v oblasti obrabotki i analiza izobrazhenij, a takzhe mashinnogo zreniya.\begin{figure}[ht]\begin{subfigure}[b]{0.5\linewidth}\centering\includegraphics[width=0.5\linewidth]{4_2_03.png}\caption{Baboon}\label{Baboon}\vspace{4ex}\end{subfigure}%%\begin{subfigure}[b]{0.5\linewidth}\centering\includegraphics[width=0.5\linewidth]{4_2_05.png}\caption{Airplane}\label{Airplane}\vspace{4ex}\end{subfigure}\begin{subfigure}[b]{0.5\linewidth}\centering\includegraphics[width=0.5\linewidth]{2_1_11.png}\caption{Earth}\label{Earth}\end{subfigure}%%\begin{subfigure}[b]{0.5\linewidth}\centering\includegraphics[width=0.5\linewidth]{4_2_07.png}\caption{Peppers}\label{Peppers}\end{subfigure}\caption{Ispol'zuemye izobrazheniya}\label{fig7}\end{figure}Vse izobrazheniya v formate TIFF i v razmere $512 \times 512$ pikselej. Cvet pikselej zakodirovan v RGB prostranstve, i sostoit iz trekh kanalov: R - krasnyj, G - zelenyj, B - sinij.$$ color_i \in \, [0 \ldots 255] $$Gde $i\, \in \, [R,G,B]$ Kazhdyj kanal predstavlyaetsya kak 8 bit, sledovatel'no kazhdyj piksel' kodiruetsya 24 bitami \cite{TIFF}.\chapter{Algoritmy steganografii} \label{chapt2}\section{Algoritm LSB} \label{sect2_1}\subsection{Model'}Sut' LSB metoda zaklyuchaetsya v zamene naimen'shih znachashchih bit v pikselyah izobrazhenij na bity skryvaemogo soobshcheniya. Izobrazhenie, izmenennoe s pomoshch'yu LSB-metoda ne dolzhno otlichat'sya ot originala pri vizual'nom kontrole dlya vypolneniya celej steganografii.Dlya primeneniya dannogo metoda neobhodimo opredelit' vhodnye parametry stego-sistemy:\begin{enumerate}\item stego-kontejner - cvetnoe izobrazhenie formata TIFF;\item vstraivaemoe soobshchenie;\item kolichestvo bit, zamenyaemoe pri vstraivanii.\end{enumerate}Oboznachim razmer izobrazheniya v pikselyah $ h \times w $, razmer soobshcheniya v bitah $ m $, kolichestvo bit, zamenyaemoe pri vstraivanii $ n $. Vmestimost' stego-kontejnera $ V $:\begin{equation}V = h \times w \times c \times n\end{equation}gde $c$ - kolichestvo kanalov pikselya, v dannom sluchae $c = 3$, tak kak rassmatrivaetsya RGB kodirovanie. Vstraivaemoe soobshchenie dolzhno vmeshchat'sya v sego-kontejner, te est' udovletvoryat' trebovaniyu:\begin{equation}m \le V\end{equation}Kolichestvo ispol'zuemyh pikselej kontejnera:\begin{equation}N = \frac{m}{c \times n}\end{equation}Dlya primera, vyberem cvetnoe izobrazhenie razmerom $512 \times 512$ pikselej i razreshim zamenyat' v ego bajtah po odnomu mladshemu bitu. Togda vmestimost' kontejnera:\begin{equation}V = 512 \times 512 \times 3 \times 1 = 768432\end{equation}Pust' vstraivaetsya soobshchenie $ "Hello" $ v kodirovke ASCII s bitovym predstavleniem $(0100100001100101011011000110110001101111)$ i razmerom $40$ bit. Togda, dlya ego vstraivaniya v kontejner potrebuetsya$$ N = \frac{40}{3} = 14 $$ pikselej.V opisannoj modeli kolichestvo zamenyaemyh bit kontejnera mozhno var'irovat'.$$ n \in [1, 2, 3, 4] $$CHem bol'she $n$, tem bol'she vmestitel'nost', no tem bol'she i zametnost' izmenenij.\subsection{Algoritm vstraivaniya}Posledovatel'nost' dejstvij, neobhodimyh dlya vstraivaniya:\begin{enumerate}\item vybor izobrazheniya;\item opredelenie soobshcheniya;\item opredelenie parametrov stego-sistemy: $ m, n, h, w, c $;\item LSB zamena;\item sohranenie $ (m,n) $ v kachestve klyucha.\end{enumerate}\subsection{Algoritm izvlecheniya}Dlya izvlecheniya neobhodimo ispol'zovat' klyuch, opredelyayushchij dlinu skrytogo soobshcheniya. Predpolagaetsya, chto klyuch peredaetsya po zashchishchennomu kanalu svyazi.Posledovatel'nost' dejstvij, neobhodimyh dlya izvlecheniya:\begin{enumerate}\item izvlechenie iz kazhdogo kanala pikselej izobrazheniya po $n$ mladshih bit;\item konkatenaciya.\end{enumerate}\section{Algoritm na osnove samoorganizuyushchihsya kart Kohonena i LSB} \label{sect2_2}\subsection{Model'}V ehtom metode predlagaetsya modificirovat' obychnyj LSB-metod ispol'zuya samoorganizuyushchuyusya kartu Kohonena dlya klasterizacii blokov izobrazheniya v zavisimosti ot kontrastnosti ih pikselej \cite{Kohonen} \cite{KOHONEN2}. Izobrazhenie delitsya na bloki, dlya kazhdogo iz kotoryh vychislyaetsya "chuvstvitel'nost'". Cveta pikselej, nahodyashchihsya v naimenee chuvstvitel'nyh zonah, imeyut bol'shij potencial nezametnyh zreniyu izmenenij. Dlya opredeleniya chuvstvitel'nosti blokov ispol'zuetsya diskretnoe vejvlet-preobrazovanie Haara.\subsection{Diskretnoe vejvlet-preobrazovanie Haara}Lyuboe diskretnoe vejvlet-preobrazovanie(dalee DVP) signala yavlyaetsya nekotoroj posledovatel'nost'yu preobrazovanij, primenyaemyh k signalu.Pust' $x$ - vhodnoj signal, DVP ehtogo signala poluchayut primeneniem nabora fil'trov. Snachala signal propuskaetsya cherez nizkochastotnyj fil'tr, oboznachim vyhodnoj signal $g$. Primenyaya NCH-fil'tr, poluchaem svertku signala:\begin{equation}y[n]_{low} = (x * g)[n] = \sum\limits_{k = - \infty }^\infty {x[k] g[2n - k]}\end{equation}Koehfficienty kotorogo nazyvayutsya koehfficientami approksimacii.Odnovremenno s ehtim, k signalu primenyaetsya vysokochastotnyj fil'tr $h$:\begin{equation}y[n]_{high} = (x * h)[n] = \sum\limits_{k = - \infty }^\infty {x[k] h[2n - k]}\end{equation}Posle primeneniya VCH-fil'tra poluchayutsya detaliziruyushchie koehfficienty.\begin{figure}[h] \center\includegraphics[width=0.7\linewidth]{WaveletsDWT.png}\caption{Skhema odnomernogo DVP}\end{figure}Pri obrabotke izobrazhenij primenyaetsya dvuhurovnevoe DVP, rezul'tatom kotorogo yavlyayutsya chetyre novyh izobrazheniya \cite{DWT}:\begin{enumerate}\item $HL$ - gorizontal'nye detali, rezul'tat primeneniya takoj posledovatel'nosti fil'trov: $ g(x * h) $;\item $HH$ - diagonal'nye detali, $ h(x * h) $;\item $LH$ - vertikal'nye detali, $ h(x * g) $;\item $LL$ - approksimaciya (szhatoe v dva raza izobrazhenie), $ g(x * g) $.\end{enumerate}Dalee, dlya polucheniya DVP sleduyushchego urovnya, ehta zhe posledovatel'nost' dejstvij primenyaetsya k $LL$ komponente. EHti preobrazovaniya pozvolyayut vydelit' vertikal'nye, gorizontal'nye i diagonal'nye osobennosti izobrazheniya, a takzhe szhat' iskhodnoe izobrazhenie \cite{DWTimg}.\begin{figure}[h]\centering\includegraphics[width=0.7\linewidth]{imageDWT.png}\caption{Skhema dvumernogo DVP}\label{fig7:a}\vspace{4ex}\end{figure}\begin{figure}[h]\centering\includegraphics[width=0.7\linewidth]{HHLL.png}\caption{Struktura DVP izobrazhenij}\label{fig7:a}\vspace{4ex}\end{figure}Vejvlet Haara, ispol'zovannyj v rabote, opredelyaetsya tak \cite{DWT2}:\begin{equation}h(x) = \sum\limits_{i = 0}^{N/2}{\frac{x_{2i} - x_{2i+1}}{2}}\end{equation}\begin{equation}g(x) = \sum\limits_{i = 0}^{N/2}{\frac{x_{2i} + x_{2i+1}}{2}}\end{equation}Rezul'taty primeneniya odnourovnevogo dvumernogo vejvlet-preobrazovaniya Haara k testovym izobrazheniyam predstavleny v prilozhenii \ref{AppendixA}.\subsection{CHuvstvitel'nost'}\label{dwtDataset}Dlya opredeleniya chuvstvitel'nosti blokov izobrazheniya neobhodimo vychislit' kontrastnost' pikselej:\begin{equation}c_i = \frac{Y_i - Y_b}{Y_b}\end{equation}Zdes' $i$ - nomer pikselya, $c_i$ - kontrastnost', $Y_i$ i $ Y_b $ - yarkost' pikselya i ego fona sootvetstvenno. V dannom metode predlagaetsya primenit' k kazhdomu bloku izobrazheniya DVP, i vychislyat' kontrastnost' pikselej iskhodya iz ego detaliziruyushchih koehfficientov i koehfficientov approksimacii\begin{equation}\begin{aligned}c^h_i = \frac{Y^{HL}_i - Y^{LL}_i}{Y^{LL}_i} \\c^v_i = \frac{Y^{LH}_i - Y^{LL}_i}{Y^{LL}_i} \\c^d_i = \frac{Y^{HH}_i - Y^{LL}_i}{Y^{LL}_i}\end{aligned}\end{equation}gde $c^h_i, c^v_i, c^d_i$ - gorizontal'naya, vertikal'naya i diagonal'naya kontrastnosti sootvetstvenno \cite{ContrastDVH}. V kachestve yarkosti fona pikselya beretsya yarkost' approksimacii. Sami yarkosti opredelyayutsya tak:\begin{equation}\label{brightness}\begin{gathered}A \times B = Y \\A = \begin{pmatrix}R_i & G_i & B_i\end{pmatrix} \\B = \begin{pmatrix}K_R\\K_G\\K_B\end{pmatrix}\end{gathered}\end{equation}gde $B$ - odna iz matric perekhoda $ RGB \Rightarrow YCbCr $, $K_R = 0.299$, $K_G = 0.587$, $K_B = 0.114$, v dannom sluchae nas interesuet tol'ko sostavlyayushchaya $Y$, opredelyayushchaya yarkost' \cite{YCbCr}.Dalee opredelyaetsya vektor chuvstvitel'nosti, sostoyashchij iz trekh komponent:\begin{equation}\begin{aligned}c^h = \frac{1}{N} \sum \limits_{i=1}^{N} c^h_i \\c^v = \frac{1}{N} \sum \limits_{i=1}^{N} c^v_i \\c^d = \frac{1}{N} \sum \limits_{i=1}^{N} c^d_i\end{aligned}\end{equation}gde $N$ - chislo pikselej v bloke, $c^h, c^v, c^d$ - srednie znacheniya gorizontal'noj, vertikal'noj i diagonal'noj kontrastnosti pikselej sootvetstvenno \cite{ContrastDVH}. V itoge, dlya kazhdogo bloka nahoditsya sootvetstvuyushchij vektor chuvstvitel'nosti:\begin{equation}S = \begin{pmatrix}c^h \\c^v \\c^d\end{pmatrix}\end{equation}Dalee ehti vektory ispol'zuyutsya dlya klasterizacii blokov s pomoshch'yu samoorganizuyushchejsya karty Kohonena.\subsection{Samoorganizuyushchayasya karta Kohonena}V dannom metode samoorganizuyushchayasya karta Kohonena (SKK) ispol'zuetsya dlya klasterizacii blokov izobrazheniya po klasteram chuvstvitel'nosti.Set' inicializiruetsya sluchajnymi vesami, razmernost' kotoryh sovpadaet s razmernost'yu vhodnyh dannyh. Dalee, set' obuchaetsya na nabore dannyh, sostoyashchim iz vektorov razmernosti $N$. Odna iteraciya obucheniya, sootvetstvuyushchaya odnomu vhodnomu vektoru $x$, nomer iteracii - $t$:\begin{enumerate}\item vychislyayutsya evklidovy rasstoyaniya mezhdu $x$ i vsemi uzlami seti:$$ \rho_i(x, w^i) = \sqrt{\sum \limits_{j=1}^{N} (x_j - w_j)^2} $$gde $w^i$ - ves i-go nejrona;\item nejron, sootvetstvuyushchij naimen'shemu $\rho$, stanovitsya "pobeditelem";\item nahodyatsya "sosedi" nejrona pobeditelya, ispol'zuya funkciyu $h$, opredelyayushchuyu "meru sosedstva":$$ h_i(t)=\alpha(t)\cdot\exp(-\frac{\|r_c-r_i\|^2}{2\sigma^2(t)}) $$gde $r_c, r_i$ - koordinaty uzlov pobeditelya i i-go nejrona, $0 < \alpha(t) < 1$ i $\sigma(t)$ - monotonno ubyvayushchie funkcii;\item znacheniya $h$ ispol'zuyutsya dlya korrektirovki vektorov vesov nejronov:$$ w^i(t) = w^i(t-1)+h_i(t)\cdot(x(t)-w^i(t-1)) $$\end{enumerate}Posle obucheniya, nejrony stanovyatsya tipichnymi predstavitelyami klasterov dannyh, ispol'zovannyh pri obuchenii. EHto pozvolyaet opredelit' k kakomu klasteru otnositsya lyuboj vektor $x$ iz obuchayushchej vyborki.EHksperimenty pokazali, chto dlya klasterizacii nabora dannyh, sformirovannogo v punkte \ref{dwtDataset}, dostatochno trekh uzlov SKK, kazhdyj iz kotoryh sootvetstvuet odnomu klasteru. Dlya obucheniya vybrany takie parametry:$$ \alpha(t) = 0.3 \frac{t}{M} $$$$ \sigma(t) = 1.5 \frac{t}{M} $$gde $M$ - obshchee chislo iteracij obucheniya.V kachestve primera dlya demonstracii raboty SKK ispol'zuetsya izobrazhenie \ref{Baboon}, kotoroe bylo predvaritel'no podeleno na bloki $8 \times 8$ pikselej. Kolichestvo blokov $ 512 \times 8 = 4096 $. Dlya kazhdogo bloka bylo opredelen vektor chuvstvitel'nosti (\ref{dwtDataset}).\begin{figure}[htp]\centering\includegraphics[width=0.7\linewidth]{baboon3d.png}\caption{Raspredelenie blokov}\label{}\vspace{4ex}\end{figure}\begin{figure}[htp]\centering\includegraphics[width=0.7\linewidth]{baboon3dclast.png}\caption{Klasterizovannye bloki}\label{}\vspace{4ex}\end{figure}\subsection{Algoritm vstraivaniya}Posledovatel'nost' dejstvij, neobhodimyh dlya vstraivaniya soobshcheniya v izobrazhenie:\begin{enumerate}\item razdelenie izobrazheniya na bloki $8 \times 8$ pikselej;\item primenenie k kazhdomu bloku DVP Haara;\item vychislenie vektora chuvstvitel'nosti kazhdogo bloka;\item klasterizaciya blokov na tri klastera chuvstvitel'nosti s pomoshch'yu SKK: $A_1$ - naibol'shaya chuvstvitel'nost', $A_2$ - srednyaya, $A_3$ - naimen'shaya;\item vstraivanie v kazhdyj blok nomer ego klastera s pomoshch'yu LSB metoda;\item LSB-zamena v kazhdom bloke v zavisimosti ot nomera ego klastera.\end{enumerate}\begin{table}[ht]\caption{Tablica sootvetstviya klasterov i zamenyaemyh bitov}\begin{center}\begin{tabular}{| c | c |}\hlineKlaster bloka & Kolichestvo zamenyaemyh bit v bajtah \\ \hline$A_1$ & 0 \\ \hline$A_2$ & 1 \\ \hline$A_3$ & 2 \\\hline\end{tabular}\end{center}\end{table}\subsection{Algoritm izvlecheniya}Posledovatel'nost' dejstvij, neobhodimyh dlya izvlecheniya soobshcheniya iz izobrazheniya:\begin{enumerate}\item razdelenie izobrazheniya na bloki $8 \times 8$ pikselej;\item izvlechenie iz kazhdogo bloka nomer ego klastera;\item izvlechenie skrytyh bit iz pikselej bloka v zavisimosti ot ego klastera;\item konkatenaciya.\end{enumerate}\section{Algoritm osnovannyj na ELM} \label{sect2_3}\subsection{Poisk optimal'noj lokacii dlya vstraivaniya} \label{oelf}Avtory algoritma \cite{ELM} predlagayut matematicheskuyu model' dlya poiska optimal'noj lokacii dlya vstraivaniya, osnovannuyu na nejroseti $ "Extreme\quad learning \quad machine" $. Dlya zashchity ot steganaliza, lyuboe iskazhenie v izobrazhenii, vyzvannoe vstraivaniem informacii, dolzhno byt' minimizirovano. Bolee togo, iskhodnoe izobrazhenie i stego-izobrazhenie dolzhny byt' v nekotorom priblizhenii identichny kak vizual'no, tak i statisticheski. Vybor oblasti vstraivaniya i vybor algoritma - klyuchevye faktory dlya izbezhaniya iskazhenij.Podgotovka nabora dannyh dlya obucheniya i testirovaniya algoritma poiska optimal'noj lokacii dlya vstraivaniya:\begin{enumerate}\item razdelenie izobrazheniya na neperesekayushchiesya bloki $8 \times 8 $ pikselej;\item opredelenie kolichestva blokov, neobhodimyh dlya vstraivaniya soobshcheniya razmerom $m$ bit;\item opredelenie naimen'shej kvadratnoj oblasti izobrazheniya, soderzhashchej neobhodimoe kolichestvo blokov:$$ SWS = 8[\sqrt{m}] \times 8[\sqrt{m}] $$\item sozdanie nabora razlichnyh kvadratnyh oblastej (v izobrazhenii) razmerom $SWS$ pikselej, s shagom v 4 pikselya:$$ NOS = \bigg( \bigg( \frac{N - SWS}{4} \bigg) + 1\bigg) \times \bigg( \bigg(\frac{M - SWS}{4}\bigg)+ 1\bigg) $$gde $N$ i $M$ - dlina i shirina izobrazheniya sootvetstvenno;\item v kazhduyu oblast' vstraivaetsya soobshchenie LSB metodom.\end{enumerate}Dalee nabor vybrannyh oblastej ispol'zuetsya dlya obucheniya (50\%), testirovaniya (40\%) i validacii (10\%) nejroseti. Obuchennaya nejroset' ispol'zuetsya dlya vybora nailuchshej oblasti dlya vstraivaniya, pri ehtom uchityvaya special'no vvedennuyu velichinu$$ fusion = \frac{Corr \times SSIM}{MSE} $$gde $Corr$ - korrelyaciya mezhdu iskhodnym izobrazheniem i stego-izobrazheniem, $SSIM$ - indeks strukturnogo skhodstva, $MSE$ - srednekvadratichnoe otklonenie.\begin{equation}Corr = 1 - \frac{cov(coverImage, stegoImage)}{\| coverImage \| \| stegoImage \|}\label{corr}\end{equation}Zdes' $cov$ - kovariaciya, $ \| f(x,y) \| $ - evklidova norma.\begin{equation}\| f(x,y) \| = \sqrt {\sum\limits_{\langle x,y \rangle\in X} {\left( {f\left({x,y} \right)-f^0} \right)^2} }\label{norm}\end{equation}gde $f^0$ - srednee znachenie intensivnosti dlya izobrazheniya, $x, y$ - prostranstvennye koordinaty.\begin{equation}cov(x,y) = \frac{1}{N} \sum\limits_{i=1}^N (x_i - E(x))(y_i - E(y))\label{cov}\end{equation}\begin{equation}E(x) = \frac{1}{N} \sum\limits_{i=1}^{N} x_i\label{mean}\end{equation}gde $N$ - kolichestvo pikselej.\begin{equation}MSE = \frac{1}{N\times M} \sum\limits_{i=0}^{N-1}\sum\limits_{j=0}^{M-1} [coverImage(i,j) - stegoImage(i,j)]^2\label{mse}\end{equation}gde $ N, M $ - dlina i shirina izobrazheniya sootvetstvenno.\begin{equation}SSIM = \frac{(2\mu_x\mu_y + C_1)(\sigma^2_{xy} + C_2)}{(\mu_x^2 + \mu_y^2 + C_1)(\sigma_x^2 + \sigma_y^2 + C_2)}\label{ssim}\end{equation}V ehtoj formule: $\mu_x$ i $\mu_y$ - lokal'nye srednie, vychislyayushchiesya po formule \ref{mean}; $\sigma_x$ i $\sigma_x$ - standartnoe otklonenie; $\sigma_{xy} = \sqrt[]{cov(x,y)}$ - kross-kovariaciya; $C_1$ i $C_2$ - konstanty.Ispol'zuya formuly \ref{corr}, \ref{mse}, \ref{ssim} vychislyaetsya velichina $fusion$, predlozhennaya avtorami v kachestve mery kachestvennosti oblasti izobrazheniya.\subsection{Algoritm vstraivaniya}Posledovatel'nost' dejstvij, neobhodimyh dlya vstraivaniya soobshcheniya v izobrazhenie:\begin{enumerate}\item poisk optimal'noj oblasti dlya vstraivaniya (\ref{oelf});\item vstraivanie;\item sohranenie koordinat vybrannoj oblasti i dliny soobshcheniya v kachestve klyucha.\end{enumerate}\subsection{Algoritm izvlecheniya}Posledovatel'nost' dejstvij, neobhodimyh dlya izvlecheniya soobshcheniya iz izobrazheniya:\begin{enumerate}\item vybor oblasti, iskhodya iz dannyh klyucha;\item razdelenie oblasti na bloki $8 \times 8$ pikselej;\item izvlechenie skrytyh bit;\item konkatenaciya.\end{enumerate}\chapter{Sravnitel'nyj analiz algoritmov} \label{chapt3}\section{Metody sravneniya} \label{sect3_1}Dlya ocenki kachestva algoritmov, opisannyh v glave \ref{chapt2}, neobhodimo matematicheski ocenit' razlichiya mezhdu iskhodnym i stego-izobrazheniem. Dlya ehtogo ispol'zuyutsya takie metriki: srednekvadratichnaya oshibka, koehfficient vzaimnoj korrelyacii, indeks strukturnogo skhodstva, a takzhe special'no vvedennaya "metrika sovpadeniya" \cite{ELM}. EHti metriki rassmatrivayut izobrazheniya kak dvumernye funkcii yarkosti ili diskretnye dvumernye matricy intensivnosti.Takzhe, vazhnym parametrom dlya ocenki kachestva raboty algoritmov yavlyaetsya maksimal'noe kolichestvo bit soobshcheniya, kotoroe mozhno vstroit' v izobrazhenie.\subsection{Srednekvadratichnaya oshibka}\label{MSE}Srednekvadratichnaya oshibka (ot angl. Mean Squared Error – MSE) ravna srednemu kvadratu raznosti yarkostej pikselej iskhodnogo i stego-izobrazheniya. Sledovatel'no, chem men'she MSE, tem men'she statisticheskie razlichiya mezhdu dvumya izobrazheniyami.\begin{equation}\label{eq:mse}MSE = \frac{1}{N \times M} \sum \limits_{i=1}^N \sum \limits_{j=1}^M (y_{ij}^o - y_{ij}^s)^2\end{equation}V ehtoj formule $N$ i $M$ - vysota i shirina izobrazheniya v pikselyah, indeksy $i$ i $j$ - prostranstvennye koordinaty kazhdogo pikselya, a velichiny $y_{ij}^o$ i $y_{ij}^s$ oboznachayut yarkosti pikslej iskhodnogo i stego-izobrazheniya i vychislyayutsya po formule (\ref{brightness}).\subsection{Koehfficient vzaimnoj korrelyacii}\label{CORR}V to vremya kak srednekvadratichnaya oshibka yavlyaetsya meroj statisticheskogo raskhozhdeniya mezhdu dvumya izobrazheniyami, koehfficient vzaimnoj korrelyacii opredelyaet meru ih skhodstva. Obychno, v takih sluchayah, vychislyaetsya kovariaciya, kotoraya, v nashem sluchae, opredelyaet meru linejnoj zavisimosti yarkostej pikselej dvuh rassmatrivaemyh izobrazhenij i vychislyaetsya po formule:\begin{equation}\label{eq:covariance}\begin{gathered}cov(original, stego) = \frac{1}{N \times M} \sum \limits_{i=1}^N \sum \limits_{j=1}^M (y_{ij}^o - \bar{y^o})(y_{ij}^s - \bar{y^s})\\\bar{y} = \frac{1}{N \times M} \sum \limits_{i=1}^N \sum \limits_{j=1}^M y_{ij}\end{gathered}\end{equation}gde $\bar{y}$ - srednee znachenie yarkosti pikselej izobrazheniya. Odnako, dannaya metrika zavisit ot linejnyh razmerov izobrazhenij, i ne podhodit dlya ocenki kachestva raboty algoritmov. Poehtomu, v rabote ispol'zuetsya normirovannyj koehfficient korrelyacii\begin{equation}\label{eq:correlation}Corr = 1 - \frac{cov(original, stego)}{\| original \| \| stego \|}\end{equation}gde dlya normirovki ispol'zuyutsya evklidovy normy dvumernyh vektorov. Dlya nekotorogo dvumernogo vektora $I$ ego evklidova norma vychislyaetsya po formule:\begin{equation}\| I \| = \sqrt{\sum \limits_{i=1}^N \sum \limits_{j=1}^M y_{ij}^2}\end{equation}\subsection{Indeks strukturnogo skhodstva}\label{SSIM}Indeks strukturnogo skhodstva (ot angl. structure similarity - SSIM) opredelyaet meru skhozhesti mezhdu dvumya izobrazheniyami. Metriki, opisannye v predydushchih razdelah (\ref{MSE}, \ref{CORR}), ocenivayut absolyutnye velichiny, togda kak SSIM osnovyvaetsya na fiziologicheskih osobennostyah vospriyatiya. Osnovnaya ideya v tom, chto dannaya metrika uchityvaet strukturnuyu informaciyu, opredelyayushchuyusya vzaimosvyazyami mezhdu pikselyami izobrazheniya. EHti vzaimosvyazi osobenno sil'no proyavlyayutsya dlya prostranstvenno blizkih pikselej i nesut informaciyu o strukture nablyudaemyh ob"ektov. Naprimer, sushchestvuet yavlenie, nazyvayushcheesya "maskirovka yarkosti" (angl. luminance masking), pri kotorom izmeneniya izobrazheniya imeyut tendenciyu byt' menee zametnymi v yarkih oblastyah.Dlya vychisleniya SSIM nam ponadobitsya takaya velichina kak dispersiya yarkosti pikselej:\begin{equation}\sigma = \sum \limits_{i=1}^N \sum \limits_{j=1}^M (y_{ij} - \bar{y})^2\end{equation}\begin{equation}\label{eq:ssim}SSIM = \frac{(2\bar{y^o}\bar{y^s} + C_1)(\sigma_{os}^2 + C_2)}{(\bar{y^o}^2 + \bar{y^s}^2 + C_1)(\sigma_o^2 + \sigma_s^2 + C_2)}\end{equation}Zdes' $\sigma_{os}^2 = cov(original, stego)$ - kovariaciya (\ref{eq:covariance}), $ \sigma_o^2 $ i $ \sigma_s^2 $ - dispersii yarkosti pikselej iskhodnogo i stego-izobrazheniya, $C_1$ i $C_2$ - dve konstanty:\begin{equation}\begin{gathered}C_1 = (k_1L)^2\\C_2 = (k_2L)^2\end{gathered}\end{equation}gde $L$ - dinamicheskij diapazon pikselej ($L = 2^{bitsPerPixel} - 1$ ), $k_1 = 0.01$ i $k_2 = 0.02$ - konstanty. Tak kak v rabote rassmatrivayutsya cvetnye RGB izobrazheniya, gde kazhdyj piksel' kodiruetsya 24-yu bitami (\ref{chapt1}), $L = 2^{24} - 1 = 16777215$.\subsection{Metrika sovpadeniya}\label{fusion}Metrika sovpadeniya vvedena dlya bolee naglyadnogo predstavleniya rezul'tatov i ob"edinyaet ranee opisannye ocenki (\ref{MSE}, \ref{CORR}, \ref{SSIM}).\begin{equation}fusion = \frac{Corr \times SSIM}{MSE}\end{equation}\section{Rezul'taty sravneniya} \label{sect3_2}V kachestve dannyh dlya sravneniya raboty algoritmov, predstavlennyh v glave \ref{chapt2}, ispol'zovalis' testovye izobrazheniya iz glavy \ref{chapt1}, v kotorye vstraivalos' soobshchenie\begin{equation*}\begin{gathered}"Comparative\,analysis \,of\, steganography \, algorithms \\based\, on\, machine\, learning,\, Chernyaev\, Ilya,\, MIPT2018"\end{gathered}\end{equation*}dlinoj 100 bajt (kodirovka ASCII). V rezul'tate, polucheny stego-izobrazheniya, s kotorymi, ispol'zuya metody, opisannye v predydushchem razdele, sravnivalis' sootvetstvuyushchie iskhodnye izobrazheniya. Vychislennye znacheniya metrik (\ref{MSE}, \ref{CORR}, \ref{SSIM}, \ref{fusion}), a takzhe rezul'taty podscheta vmestimosti izobrazhenij dlya trekh algoritmov predstavleny v tablicah nizhe.\begin{table}[h]\centering\begin{center}\caption{Rezul'taty vychislenij metrik}\label{byte}\end{center}\begin{tabular}{|c|c|cccc|}\hline\textbf{Izobr.} & \textbf{Algoritm} & \multicolumn{1}{c|}{\textbf{MSE}} & \multicolumn{1}{c|}{\textbf{Corr}} & \multicolumn{1}{c|}{\textbf{SSIM}} & \textbf{fusion} \\ \hline\textbf{} & LSB & 0.0029251 & 0.999999617 & 0.9961395 & 340.560 \\ \cline{2-2}\textbf{baboon} & Kohonen & 0.0045018 & 0.999999617 & 0.9961390 & 221.276 \\ \cline{2-2}\textbf{} & ELM & 0.0011260 & 0.999999000 & 0.9999970 & 888.096 \\ \cline{1-2}\textbf{} & LSB & 0.0027219 & 0.999999742 & 0.9952330 & 365.894 \\ \cline{2-2}\textbf{airplane} & Kohonen & 0.0094177 & 0.999999742 & 0.9952330 & 105.677 \\ \cline{2-2}\textbf{} & ELM & 0.0011150 & 0.999999000 & 0.9999760 & 896.839 \\ \cline{1-2}\textbf{} & LSB & 0.0025013 & 0.999999233 & 0.9926476 & 396.900 \\ \cline{2-2}\textbf{peppers} & Kohonen & 0.0073606 & 0.999999233 & 0.9926470 & 134.859 \\ \cline{2-2}\textbf{} & ELM & 0.0011560 & 0.999999000 & 0.9999850 & 865.038 \\ \cline{1-2}\textbf{} & LSB & 0.0026912 & 0.999999426 & 0.9956740 & 369.973 \\ \cline{2-2}\textbf{earth} & Kohonen & 0.0048660 & 0.999999426 & 0.9956740 & 204.618 \\ \cline{2-2}& ELM & 0.0011310 & 0.999999000 & 0.9999600 & 884.137 \\ \hline\end{tabular}\end{table}Vo vtorom stolbce dannoj tablicy vvedeny korotkie oboznacheniya, sootvetstvuyushchie algoritmam: $"LSB"$ - \ref{sect2_1}, $"Kohonen"$ - algoritm na osnove samoorganizuyushchihsya kart Kohonena i LSB (\ref{sect2_2}), $"ELM"$ - algoritm osnovannyj na ELM (\ref{sect2_3}). Analogichnym obrazom, oboznacheny ispol'zovannye izobrazheniya: $"baboon" (\ref{Baboon})$, $"airplane" (\ref{Airplane})$, $"peppers" (\ref{Peppers})$, $"earth" (\ref{Earth})$. Vse velichiny okrugleny do nekotoryh znachashchih poryadkov.\begin{table}[htp]\centering\begin{center}\caption{Vmestimost' RGB izobrazhenij razmerom $512 \times 512$ piskelej}\end{center}\label{capacity}\begin{tabular}{|c|c|c|c|}\hline\textbf{Izobr.} & \textbf{Algoritm} & \multicolumn{1}{c|}{\textbf{Vmestimost'(bit)}} & \multicolumn{1}{c|}{\textbf{Kol. simvolov (ASCII)}} \\ \hline\textbf{} & LSB & 768432 & 98304 \\ \cline{2-2}\textbf{baboon} & Kohonen & 1075916 & 134489 \\ \cline{2-2}\textbf{} & ELM & 768432 & 98304 \\ \cline{1-2}\textbf{} & LSB & 768432 & 98304 \\ \cline{2-2}\textbf{airplane} & Kohonen & 1003714 & 125464 \\ \cline{2-2}\textbf{} & ELM & 768432 & 98304 \\ \cline{1-2}\textbf{} & LSB & 768432 & 98304 \\ \cline{2-2}\textbf{peppers} & Kohonen & 908276 & 113534 \\ \cline{2-2}\textbf{} & ELM & 768432 & 98304 \\ \cline{1-2}\textbf{} & LSB & 768432 & 98304 \\ \cline{2-2}\textbf{earth} & Kohonen & 712214 & 89026 \\ \cline{2-2}\textbf{} & ELM & 768432 & 98304 \\ \hline\end{tabular}\end{table}Dlya bolee naglyadnogo predstavleniya rezul'tatov, po dannym iz tablicy \ref{byte} postroeny diagrammy:\begin{figure}[htp]\centering\includegraphics[width=0.7\linewidth]{MSE.png}\caption{Srednekvadratichnoe otklonenie}\label{fig:MSEchart}\end{figure}\begin{figure}[htp]\centering\includegraphics[width=0.7\linewidth]{corr.png}\caption{Normirovannyj koehfficient korrelyacii}\label{Corrchart}\end{figure}\begin{figure}[htp]\centering\includegraphics[width=0.7\linewidth]{ssim.png}\caption{Indeks strukturnogo skhodstva}\label{SSIMchart}\end{figure}\begin{figure}[htp]\centering\includegraphics[width=0.7\linewidth]{fusion.png}\caption{Metrika sovpadeniya}\label{fusionchart}\end{figure}\subsection{Analiz rezul'tatov}\label{analysis}Kak vidno iz diagrammy (ris. \ref{fig:MSEchart}) luchshie rezul'taty otnositel'no srednekvadratichnogo otkloneniya pokazal algoritm osnovannyj na ELM (\ref{sect2_3}), ehto ob"yasnyaetsya tem, chto ideya metoda zaklyuchaetsya v uchete statisticheskih osobennostej pri vybore oblasti dlya vstraivaniya. V chastnosti, oblast', kotoraya pri vstraivanii soobshcheniya daet naimen'shij prirost obshchego MSE, s bol'shoj veroyatnost'yu budet vybrana kak okonchatel'nyj variant dlya ispol'zovaniya. Dva drugih algoritma, ozhidaemo, pokazali bol'shie znacheniya srednekvadratichnogo otkloneniya, tak kak v ih modelyah ne uchityvayutsya takie metriki kak MSE. Metod LSB (\ref{sect2_1}) imeet srednie pokazateli, togda kak znachenie MSE dlya algoritma, osnovannogo na SKK (\ref{sect2_2}), v nekotoryh sluchayah, bol'she na poryadok. Naprimer, dlya izobrazheniya \ref{Airplane} znachenie MSE dostigaet 0.0094177, ehto obuslovleno osobennostyami samogo izobrazheniya. Kak ukazano v punkte \ref{sect2_2}, algoritm mozhet zamenyat' po dva mladshih bita, chto i daet znachitel'noe uvelichenie statisticheskogo otlichiya mezhdu iskhodnym i stego-izobrazheniem.Znacheniya normirovannogo koehfficienta korrelyacii dlya vsekh algoritmov odinakovy s tochnost'yu do $10^{-6}$ i ravny 0.999999. Sledovatel'no, izmeneniya yarkosti pikselej pri rabote algoritmov neznachitel'ny.Dlya ocenki vypolneniya odnoj iz glavnyh celej steganografii, podrazumevayushchej nezametnost' peredachi dannyh, naibol'shij interes predstavlyaet indeks strukturnogo skhodstva. Otnositel'no SSIM, luchshim iz rassmotrennyh algoritmov okazalsya $"ELM"$, v modeli kotorogo uchityvaetsya ehta velichina. Metody $"LSB"$ i $"Kohonen"$ pokazali odinakovye (s tochnost'yu do $10^{-3}$ ) rezul'taty. V celom, vse tri algoritma imeyut dostatochno blizkie k edinice znacheniya SSIM, chto govorit o vysokoj stepeni nezametnosti izmenenij.Nemalovazhnuyu rol' v ocenke kachestva algoritmov igraet maksimal'noe kolichestvo bit soobshcheniya, kotoroe mozhno vstroit' v izobrazheniya, pol'zuyas' tem ili inym metodom. V to vremya, kak v modelyah $"LSB"$ i $"ELM"$ ehta velichina ogranichena, v modeli $"Kohonen"$ ona zavisit ot osobennostej izobrazheniya. Teoreticheski vozmozhno podobrat' takoe izobrazhenie, chto ego vmestimost' dlya algoritma $"Kohonen"$ budet v dva raza bol'she analogichnyh pokazatelej drugih algoritmov, predstavlennyh v rabote.\begin{enumerate}\item Vypolnen sravnitel'nyj analiz trekh algoritmov steganografii, kotoryj pokazal, chto modifikacii, osnovannye na primenenii tekhnologij mashinnogo obucheniya, mogut uvelichit' ehffektivnost' obychnyh algoritmov steganografii.\item Postroena matematicheskaya model' dlya sravnitel'nogo analiza, kotoraya vklyuchaet v sebya statisticheskie metody, uchityvayushchie osobennosti izobrazhenij i ih vospriyatiya chelovecheskim zreniem. Dannaya model' ne zavisit ot algoritmov i mozhet byt' primenena dlya sravneniya lyubyh sushchestvuyushchih tekhnik steganografii s ispol'zovaniem izobrazhenij.\item Dlya vypolneniya postavlennyh zadach realizovano dva algoritma steganografii i matematicheskaya model' dlya ih sravneniya.\item Proveden obzor odnogo iz sushchestvuyushchih algoritmov steganografii, osnovannogo na mashinnom obuchenii dlya sravneniya ego s realizovannymi algoritmami.\end{enumerate}
